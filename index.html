<!DOCTYPE html>
<html>
<head>
    <title>Food Ordering Website</title>

    <link rel="stylesheet" type="text/css" href="style.css">

    <script src="https://code.jquery.com/jquery-3.2.0.js"></script>
</head>

<body>

    <!-- Modal -->
    <div class="modalContainer">
      <div class="modal-header">
          <span class="close">&times;</span>
          <h2>Details</h2>
      </div>
      <div class="modal-body">
        <div id = "ingredients"></div>
        <div id = "price"></div>
      </div>
      <div class="modal-footer">
      </div>
    </div>


    <!-- Navbar -->
    <header>
        <ul>
            <a href="index.html">
                <li id="home">Home</li>
            </a>
            <a href="cart.html">
                <li id="cart">Cart (0)</li>
            </a>
            <a href="login.html">
                <li id="login">Login/Register</li>
            </a>
        </ul>
    </header>

    <!-- Title -->
    <div>
        <h1>Menu</h1>
    </div>

    <!-- Menu -->
    <div class="menu-container">
      <div class="menu">
      </div>
    </div>

    <!-- Footer -->
    <footer>
        <p>Contact</p>
    </footer>

    <!-- Javascript -->
    <script>

        $.ajax({
          url: "http://thiman.me:1337/menu/kody",
          type: "GET",
          success:(function(e){
            menu = e;

            // Select menu Container
            var menuContainer = $('.menu-container');

            // Create button
            var button = $('<button/>').addClass("button").html("Add to Cart");

            // Loop through menu in database
            for (var i = 0; i < menu.length; i++){

                var item = menu[i];

                // Create menu item with title and menu id
                var container = $('<div/>').addClass('menu-item');

                var title = $('<div/>').addClass('title').html(item.title);
                var itemEle = $('<div/>')
                              .addClass('item')
                              .attr("id", `menu-${i}`);

                // insert image
                var image = $('<img/>').attr("src", item.img).attr("id", i);
                itemEle.append(image);

                container.append(title).append(itemEle).append(button.clone());

                menuContainer.append(container);
            }

            // Create modal
            var modalContainer = $('.modalContainer');

            $('.menu-item .item img').on('click', function(e){
              // get index of item
              var index = parseInt($(this).attr("id"));
              var item = menu[index];

              console.log(item.ingredients);
              console.log(item.price);

              $("#ingredients").html(`Ingredients: ${item.ingredients}`);
              $("#price").html(`Price: \$${item.price}`);

              modalContainer.css("display","block");
            })

          })
        });


        // EVENT DELEGATION


        // var button = $(".button");
        // button.on('click', ".button", function(e){
        //   console.log('helo');
        // });
        //
        // var modal = $('.modalContainer');
        //
        // $(window).on('click', function(event){
        //   var element = $(this);
        //   console.log(element);
        //   if (event.target == modal) {
        //       console.log("hello");
        //       modal.css("display","none");
        //   }
        // });
        //
        // window.onclick = function(event) {
        //     if (event.target == modal) {
        //         console.log("hello");
        //         modal.style.display = "none";
        //     }
        // }
        //


        document.querySelectorAll("button").forEach(
            function(obj) {
                obj.addEventListener('click',
                    function() {

                        cartNumber++;

                        cart.innerHTML = "Cart (" + cartNumber + ")";
                    }
                )
            }
        );


    </script>

</body>
</html>
